<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Welcome</title>
    <link type="text/css" rel="stylesheet" href="bulma.min.css" />
    <link type="text/css" rel="stylesheet" href="index.css" />
    <link type="text/css" rel="stylesheet" href="fa/css/all.min.css" />
</head>
<body>
<div style="position: absolute; height: 100%; width: 100%; left: 0; top: 0; padding: 16px;">
    <div align="center" class="valign">
        <img src="img/logo-full.png" alt="logo" id="home-logo" style="width: 170px;">
        <p style="margin-bottom: 24px;">Selamat datang! Silakan buat atau buka sesi pengambilan suara.</p>

        <a href="wizard_new.html">
            <span class="icon is-small">
              <i class="fas fa-plus"></i>
            </span>
            New Session
        </a>
        &nbsp;
        <a href="javascript: open()">
            <span class="icon is-small">
              <i class="fas fa-file"></i>
            </span>
            Open
        </a>
    </div>
</div>

<script type="text/javascript">
    const {dialog} = require('electron').remote;
    const ipcRenderer = require('electron').ipcRenderer;
    const fs = require('fs');
    const path = require('path');

    function open() {
        dialog.showOpenDialog({
            properties: ['openDirectory'],
            title: "Select working directory"
        }, function (destPath) {
            if (destPath !== undefined) {
                let DB_PATH = path.join(destPath[0], 'vote.db');

                if(fs.existsSync(DB_PATH)) {
                    ipcRenderer.send("open_working_dir", destPath[0]);
                    window.location.href = "wizard_start.html";
                } else {
                    alert("Invalid working directory");
                }
            }
        });
    }
</script>
</body>
</html>